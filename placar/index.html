<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
  />
  <title>Placar Interativo</title>

  <!-- Web App Meta Tags para comportamento "tela cheia" em mobile -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Placar">
  <meta name="theme-color" content="#111111">

  <link rel="icon" href="favicon.png" type="image/svg+xml">
  <link rel="apple-touch-icon" href="favicon.png" type="image/svg+xml">

  <script src="vue3518.js"></script>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Roboto Mono';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url(L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2_SeW4Ep0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }
    /* cyrillic */
    @font-face {
      font-family: 'Roboto Mono';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url(L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2_QOW4Ep0.woff2) format('woff2');
      unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }
    /* greek */
    @font-face {
      font-family: 'Roboto Mono';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url(L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2_R-W4Ep0.woff2) format('woff2');
      unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
    }
    /* vietnamese */
    @font-face {
      font-family: 'Roboto Mono';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url(L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2_S-W4Ep0.woff2) format('woff2');
      unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
    }
    /* latin-ext */
    @font-face {
      font-family: 'Roboto Mono';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url(L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2_SuW4Ep0.woff2) format('woff2');
      unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }
    /* latin */
    @font-face {
      font-family: 'Roboto Mono';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url(L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_Of2_ROW4.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }


    /* Reseta estilos básicos e define a fonte */
    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden; /* Evita barras de rolagem */
      font-family: "Roboto Mono", monospace;
      background-color: #111;
    }

    /* Regra geral para transições suaves e rápidas */
    * {
      transition: all 0.4s ease-in-out;
    }

    #fullscreen-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.85); /* Fundo escuro semi-transparente */
      z-index: 9999; /* Garante que está acima de tudo */
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      opacity: 1; /* Para transição */
    }

    #fullscreen-overlay.hidden {
      opacity: 0;
      pointer-events: none; /* Impede cliques quando escondido */
    }

    #fullscreen-button {
      background-color: #2980b9;
      border: 2px solid #3498db;
      color: white;
      padding: 20px 40px;
      font-family: "Roboto Mono", monospace;
      font-size: 24px;
      font-weight: bold;
      border-radius: 12px;
      cursor: pointer;
    }
    #fullscreen-button:hover {
      background-color: #3498db;
    }
    #fullscreen-button:active {
      transform: scale(0.95);
    }

    #rotation-wrapper {
      width: 100%;
      height: 100%;
    }

    /* Força a orientação paisagem apenas em dispositivos de toque (celulares/tablets).
    */
    @media (orientation: portrait) and (hover: none) and (pointer: coarse) {
      #rotation-wrapper {
        width: 100vh;
        height: 100vw;
        overflow: hidden;
        position: fixed; /* CORREÇÃO: Usar fixed para ancorar na viewport, mais robusto em mobile */
        top: 0;
        left: 0;

        transform-origin: top left;
        transform: translateY(100vh) rotate(-90deg);
      }
      .score {
        font-size: 120vw !important;
      }

      .score.score-reduced {
        font-size: 90vw !important;
      }

      .timer-display {
        font-size: 4vw !important;
      }

      .timer-container.timer-paused .timer-display {
        font-size: 8vw !important; /* Dobro da fonte quando pausado */
      }
    }

    #app {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .scoreboard {
      display: flex;
      width: 100%;
      height: 100%;
    }

    .team {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      position: relative;
      user-select: none;
      cursor: pointer;
    }

    .team-a { background-color: #F00; }

    .team-b { background-color: #00F; }

    .team-name {
      font-size: 2rem;
      font-weight: bold;
      text-transform: uppercase;
      position: absolute;
      top: 0;
      cursor: pointer; /* Indica que o nome é clicável */
      z-index: 10; /* Garante que o nome esteja acima da área de clique do placar */
    }

    .score {
      font-size: 120vh;
      font-weight: bold;
      line-height: 1;
    }

    .score.score-reduced {
      font-size: 90vh;
    }

    .timer-container {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      background-color: rgba(0, 0, 0, 0.4);
      padding: 5px 25px;
      border-radius: 20px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      cursor: pointer; /* Adicionado para indicar que é clicável */
    }

    .timer-container.timer-paused {
      background-color: #e67e22; /* Laranja */
      border-color: #f39c12;
    }

    .timer-display {
      font-size: 4vh;
      color: white;
      font-weight: bold;
    }

    .timer-container.timer-paused .timer-display {
      font-size: 8vh; /* Dobro da fonte quando pausado */
    }

    .controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }

    .reset-button {
      background-color: rgba(255, 255, 255, 0.2);
      border: 2px solid rgba(255, 255, 255, 0.5);
      color: white;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .reset-button:hover {
      background-color: rgba(255, 255, 255, 0.4);
    }

    .reset-button svg {
      width: 28px;
      height: 28px;
    }
  </style>
</head>
<body>

<div id="fullscreen-overlay" class="hidden">
  <button id="fullscreen-button" onclick="handleFullscreenRequest()">Entrar em Tela Cheia</button>
</div>

<!-- SCRIPT ISOLADO E GLOBAL PARA TELA CHEIA -->
<script>
  function handleFullscreenRequest() {
    const docEl = document.documentElement;
    if (docEl.requestFullscreen) {
      docEl.requestFullscreen();
    } else if (docEl.webkitRequestFullscreen) {
      docEl.webkitRequestFullscreen();
    }
  }

  function updateFullscreenUI() {
    const overlay = document.getElementById('fullscreen-overlay');
    if (!overlay) return;

    // document.fullscreenElement será nulo se não estiver em tela cheia
    if (document.fullscreenElement || document.webkitFullscreenElement) {
      overlay.classList.add('hidden');
    } else {
      overlay.classList.remove('hidden');
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    const overlay = document.getElementById('fullscreen-overlay');
    const docEl = document.documentElement;
    if (!docEl.requestFullscreen && !docEl.webkitRequestFullscreen) {
      if (overlay) overlay.remove(); // Remove completamente se a API não existe
    } else {
      // Adiciona os listeners e atualiza a UI para o estado inicial
      document.addEventListener('fullscreenchange', updateFullscreenUI);
      document.addEventListener('webkitfullscreenchange', updateFullscreenUI);
      updateFullscreenUI(); // Chama uma vez para definir o estado correto no carregamento
    }
  });
</script>


<div id="rotation-wrapper">
  <div id="app">
    <div class="timer-container" :class="{ 'timer-paused': !timerIsRunning && timerTotalSeconds > 0 }" @click.stop="swapTeamNames">
      <span class="timer-display">{{ formattedTime }}</span>
    </div>

    <div class="scoreboard">
      <div
        class="team team-a"
        @mousedown.prevent="pressStart('A')"
        @mouseup="pressEnd('A')"
        @touchstart.prevent="pressStart('A')"
        @touchend="pressEnd('A')"
        @contextmenu.prevent
      >
        <div class="team-name" @click.stop="swapTeamNames">{{ teamAName }}</div>
        <div class="score" :class="{ 'score-reduced': scoreA > 9 && scoreB > 9 }">{{ scoreA }}</div>
      </div>
      <div
        class="team team-b"
        @mousedown.prevent="pressStart('B')"
        @mouseup="pressEnd('B')"
        @touchstart.prevent="pressStart('B')"
        @touchend="pressEnd('B')"
        @contextmenu.prevent
      >
        <div class="team-name" @click.stop="swapTeamNames">{{ teamBName }}</div>
        <div class="score" :class="{ 'score-reduced': scoreA > 9 && scoreB > 9 }">{{ scoreB }}</div>
      </div>
    </div>

    <div class="controls">
      <button
        @click.stop="resetGame"
        class="reset-button"
        title="Zerar Placar e Pausar Cronômetro"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white">
          <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<script>
  const { createApp } = Vue

  createApp({
    data() {
      return {
        scoreA: 0,
        scoreB: 0,
        teamAName: 'PORTA',
        teamBName: 'Fundo',
        timerTotalSeconds: 0,
        timerIsRunning: false,
        timerId: null,
        wakeLock: null,
        longPressTimer: null,
        isLongPress: false,
        longPressDuration: 500,
      }
    },
    computed: {
      formattedTime() {
        const minutes = Math.floor(this.timerTotalSeconds / 60)
        const seconds = this.timerTotalSeconds % 60
        return `${String(minutes).padStart(2, "0")}:${String(seconds).padStart(2, "0")}`
      },
    },
    methods: {
      swapTeamNames() {
        const tempName = this.teamAName
        this.teamAName = this.teamBName
        this.teamBName = tempName
      },
      resetGame() {
        this.scoreA = 0
        this.scoreB = 0
        this.pauseTimer()
      },
      startTimer() {
        if (this.timerIsRunning) return
        this.timerIsRunning = true
        this.requestWakeLock()
        this.timerId = setInterval(() => { this.timerTotalSeconds++ }, 1000)
      },
      pauseTimer() {
        this.timerIsRunning = false
        clearInterval(this.timerId)
        this.releaseWakeLock()
      },
      async requestWakeLock() {
        if ("wakeLock" in navigator) {
          try {
            this.wakeLock = await navigator.wakeLock.request("screen")
            this.wakeLock.addEventListener("release", () => { console.log("Wake Lock foi liberado pelo sistema.") })
            console.log("Wake Lock está ativo.")
          } catch (err) {
            console.error(`Não foi possível ativar o Wake Lock: ${err.name}, ${err.message}`)
          }
        } else {
          console.log("API Wake Lock não é suportada neste navegador.")
        }
      },
      async releaseWakeLock() {
        if (this.wakeLock !== null) {
          try {
            await this.wakeLock.release()
            this.wakeLock = null
            console.log("Wake Lock foi liberado.")
          } catch (err) {
            console.error(`Falha ao liberar o Wake Lock: ${err.name}, ${err.message}`)
          }
        }
      },
      incrementScore(team) {
        const wasGameAtZero = this.scoreA === 0 && this.scoreB === 0

        if (team === "A") this.scoreA++
        else this.scoreB++

        if (wasGameAtZero) {
          this.timerTotalSeconds = 30
          this.startTimer()
        }
      },
      decrementScore(team) {
        if (team === "A" && this.scoreA > 0) this.scoreA--
        else if (team === "B" && this.scoreB > 0) this.scoreB--
      },
      pressStart(team) {
        this.isLongPress = false
        this.longPressTimer = setTimeout(() => {
          this.decrementScore(team)
          this.isLongPress = true
        }, this.longPressDuration)
      },
      pressEnd(team) {
        clearTimeout(this.longPressTimer)
        if (!this.isLongPress) this.incrementScore(team)
      },
      handleVisibilityChange() {
        if (this.wakeLock !== null && document.visibilityState === "visible") {
          this.requestWakeLock()
        }
      },
    },
    mounted() {
      document.addEventListener("visibilitychange", this.handleVisibilityChange)
    },
    beforeUnmount() {
      this.pauseTimer()
      document.removeEventListener("visibilitychange", this.handleVisibilityChange)
    },
  }).mount("#app")
</script>
</body>
</html>